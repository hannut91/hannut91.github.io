<!doctype html>

<html class="no-js" lang="en">

<head>


	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

	Yunseok's Dev Blog

	Simples Theme by https://jekyllthemes.io
	Premium + free Jekyll themes for your blog or website.

	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<!-- Page Info -->
	<link rel="shortcut icon" href="/images/favicon.png">
	<title>Express Using Middleware – Yunseok's Dev Blog</title>
	<meta name="description" content="Express에서 미들웨어 사용하기">

	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="Express Using Middleware – Yunseok's Dev Blog">
	<meta name="twitter:description" content="Express에서 미들웨어 사용하기">
	<meta name="twitter:image:src" content="http://localhost:4000">

	<!-- Facebook OpenGraph -->
	<meta property="og:title" content="Express Using Middleware – Yunseok's Dev Blog" />
	<meta property="og:description" content="Express에서 미들웨어 사용하기" />
	<meta property="og:image" content="http://localhost:4000" />

	
	<!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=Nunito:300,400,400i,600" rel="stylesheet">
	

	<!-- Styles -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/css/style.css">
	
	<!-- Icons -->
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/solid.js" integrity="sha384-GXi56ipjsBwAe6v5X4xSrVNXGOmpdJYZEEh/0/GqJ3JTHsfDsF8v0YQvZCJYAiGu" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/brands.js" integrity="sha384-0inRy4HkP0hJ038ZyfQ4vLl+F4POKbqnaUB6ewmU4dWP0ki8Q27A0VFiVRIpscvL" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/fontawesome.js" integrity="sha384-NY6PHjYLP2f+gL3uaVfqUZImmw71ArL9+Roi9o+I4+RBqArA2CfW1sJ1wkABFfPe" crossorigin="anonymous"></script>

	
	<!-- Custom Styles -->
	<style></style>
	

	
	<!-- Analytics Code -->
	
	

	
	<!-- Extra Header JS Code -->
	
	
	
</head>


<body class="loading ajax-loading" data-site-url="http://localhost:4000" data-page-url="/blogs/express/08.using-middleware">


	<header class="header">

	<div class="wrap">

		
		<a href="/" class="header__avatar">
			<img src="/images/profile.jpg" class="header__avatar__img">
		</a>
		

		
		<a href="/" class="header__title">
			Yunseok's Dev Blog
		</a>
		

		<p class="header__tagline">배운 것을 적는 블로그입니다.</p>

		<div class="menu">
			<ul class="menu__list">
				
				<li class="menu__list__item">
					<a href="/" class="menu__list__item__link">Latest</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/about" class="menu__list__item__link">About</a>
				</li>
				
			</ul>
		</div>

	</div>

</header>


	<div class="loader"><svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg></div>

	<div class="page-loader"></div>

	
	<div class="page">

		<div class="page__content" data-page-title="Express Using Middleware – Yunseok's Dev Blog" data-image="">

			<section class="single">

	<div class="wrap">

		<h1>Express Using Middleware</h1>
		<p class="subtitle"></p>

		<ul>
  <li><code class="highlighter-rouge">Express</code>는 최소한의 기능을 가지고 있는 라우팅과 미들웨어 웹
프레임워크입니다. <code class="highlighter-rouge">Express</code>는 일련의 미들웨어 함수를 실행하는
어플리케션입니다.</li>
  <li>미들웨어함수들은 request object(<code class="highlighter-rouge">req</code>)와 response object(<code class="highlighter-rouge">res</code>)에 접근할 수
있고 다음 미들웨어 함수를 실행도록 <code class="highlighter-rouge">next</code>를 실행할 수 있습니다.</li>
  <li>미들웨어는
    <ul>
      <li>어떤 코드든 실행할 수 있습니다.</li>
      <li>request와 reponse객체를 변경할 수 있습니다.</li>
      <li><code class="highlighter-rouge">request-response</code>사이클을 끝낼 수 있습니다.</li>
      <li>다음 미들웨어함수를 실행할 수 있습니다.</li>
    </ul>
  </li>
  <li>만약 현재 미들웨어 함수가 request-response사이클을 끝내지 않는다면 반드시
<code class="highlighter-rouge">next()</code>를 호출해야합니다. 응답을 끝내지 않은채로 남아있을 수 있습니다.</li>
  <li>Express어플리케이션은 다양한 종류들의 미들웨어를 사용할 수 있습니다.
    <ul>
      <li><a href="https://expressjs.com/en/guide/using-middleware.html#middleware.application">어플리케이션 레벨 미들웨어</a></li>
      <li><a href="https://expressjs.com/en/guide/using-middleware.html#middleware.router">라우터 레벨 미들웨어</a></li>
      <li><a href="https://expressjs.com/en/guide/using-middleware.html#middleware.error-handling">에러 핸들링 미들웨어</a></li>
      <li><a href="https://expressjs.com/en/guide/using-middleware.html#middleware.built-in">빌트인 미들웨어</a></li>
      <li><a href="https://expressjs.com/en/guide/using-middleware.html#middleware.third-party">써드파티 미들웨어</a></li>
    </ul>
  </li>
</ul>

<h2 id="application-level-middleware">Application-level middleware</h2>

<ul>
  <li>어플리케이션 레벨 미들웨어를 <a href="https://expressjs.com/en/4x/api.html#app">app object</a>에 <code class="highlighter-rouge">app.use()</code>함수와 <code class="highlighter-rouge">app.METHOD</code>함수를 이용하여 할당할 수 있습니다.</li>
  <li>다음 예는 mount path없이 미들웨어 함수를 사용합니다. 이 함수는 앱에서 모든 
요청마다 실행됩니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Time:'</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>다음 예에서 함수는 모든 <code class="highlighter-rouge">/user/:id</code>에 요청할 때 마다 실행되는 미들웨어
함수입니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Request Type:'</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>다음 예는 GET요청으로 <code class="highlighter-rouge">/user/:id로</code>로 요청했을 때 실행되는 핸들러 함수입니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'USER'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>다음 예는 여러개의 함수를 등록하고 있습니다. <code class="highlighter-rouge">/user/:id</code>로 요청할 떄 마다
실행되는 미들웨어함수들입니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Request URL:'</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">originalUrl</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Request Type:'</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>라우트 핸들러들은 path에 대하여 여러개의 라우트를 정의할 수 있습니다.</li>
  <li>다음예에서 두번 쟤 라우트에서 어떤 에러도 발생하지 않지만 절대 실행되지
않습니다. 왜냐하면 첫 번째 라우트가 <code class="highlighter-rouge">request-response</code>사이클을 끝내기
때문입니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'ID:'</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'User Info'</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1">// handler for the /user/:id path, which prints the user ID</span>
<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>라우터 미들웨어 스택에서 나머지 미들웨어함수들을 스킵하려면
<code class="highlighter-rouge">next('route')</code>함수를 호출하면됩니다.</li>
  <li><code class="highlighter-rouge">next('route')</code>는 <code class="highlighter-rouge">app.METHOD()</code>나 <code class="highlighter-rouge">router.METHOD()</code>를 통해 로드된
미들웨어에서만 동작합니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// if the user ID is 0, skip to the next route</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">'0'</span><span class="p">)</span> <span class="nx">next</span><span class="p">(</span><span class="s1">'route'</span><span class="p">)</span>
  <span class="c1">// otherwise pass the control to the next middleware function in this stack</span>
  <span class="k">else</span> <span class="nx">next</span><span class="p">()</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// send a regular response</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'regular'</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1">// handler for the /user/:id path, which sends a special response</span>
<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'special'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="router-level-middleware">Router-level middleware</h2>

<ul>
  <li><code class="highlighter-rouge">express.Router()</code>를 사용한다는것을 제외하면 라우터레벨 미들웨어는 
어플리케이션 레벨 미들웨어와 똑같이 동작합니다.</li>
  <li><code class="highlighter-rouge">router.user()</code>와 <code class="highlighter-rouge">router.METHOD()</code>를 사용하여 미들웨어를 로드할 수 있습니다.</li>
  <li>다음 예는 위의 어플리케이션 레벨 미들웨어 사용 예제를 라우터 레벨 미들웨어를
사용해서 로드한 예제입니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">()</span>

<span class="c1">// a middleware function with no mount path. This code is executed for every request to the router</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Time:'</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>

<span class="c1">// a middleware sub-stack shows request info for any type of HTTP request to the /user/:id path</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Request URL:'</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">originalUrl</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Request Type:'</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>

<span class="c1">// a middleware sub-stack that handles GET requests to the /user/:id path</span>
<span class="nx">router</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// if the user ID is 0, skip to the next router</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">'0'</span><span class="p">)</span> <span class="nx">next</span><span class="p">(</span><span class="s1">'route'</span><span class="p">)</span>
  <span class="c1">// otherwise pass control to the next middleware function in this stack</span>
  <span class="k">else</span> <span class="nx">next</span><span class="p">()</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// render a regular page</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'regular'</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1">// handler for the /user/:id path, which renders a special page</span>
<span class="nx">router</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/user/:id'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'special'</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1">// mount the router on the app</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nx">router</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>나머지 미들웨어들은 스킵하기위해서는 <code class="highlighter-rouge">next('router')</code>를 호출하면 됩니다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">()</span>

<span class="c1">// predicate the router with a check and bail out when needed</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">'x-auth'</span><span class="p">])</span> <span class="k">return</span> <span class="nx">next</span><span class="p">(</span><span class="s1">'router'</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>

<span class="nx">router</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'hello, user!'</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1">// use the router and 401 anything falling through</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/admin'</span><span class="p">,</span> <span class="nx">router</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendStatus</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="error-handling-middleware">Error-handling middleware</h2>

<ul>
  <li>에러 핸들링은 미들웨어는 항상 4개의 인수를 받는 함수여야 합니다.</li>
  <li>미들웨어함수를 등록하는 방법이랑 비슷하지만 미들웨어가 4개의 인수를 받아야
합니다.</li>
  <li>자세한 내용은 <a href="https://expressjs.com/en/guide/error-handling.html">Error handling</a>을 참고해주세요.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">stack</span><span class="p">)</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">'Something broke!'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="built-in-middleware">Built-in middleware</h2>

<ul>
  <li><a href="https://expressjs.com/en/4x/api.html#express.static">express.static</a>
HTML이나 이미지들을 서빙합니다.</li>
  <li><a href="https://expressjs.com/en/4x/api.html#express.json">express.json</a> JSON으로 온
요청데이터를 처리하는데 사용됩니다.</li>
  <li><a href="https://expressjs.com/en/4x/api.html#express.urlencoded">exrpess.urlencoded</a>
URL-encoded요청을 처리하는데 사용됩니다.</li>
</ul>

<h2 id="third-party-middleware">Third-party middleware</h2>

<ul>
  <li><code class="highlighter-rouge">Express</code>앱에서 다양한 기능들을 추가하기위해 써드파티 미들웨어를 사용할 수
있습니다.</li>
  <li><a href="https://expressjs.com/en/resources/middleware.html">미들웨어 목록</a></li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm install cookie-parser
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">cookieParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'cookie-parser'</span><span class="p">)</span>

<span class="c1">// load the cookie-parsing middleware</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">cookieParser</span><span class="p">())</span>
</code></pre></div></div>

<h2 id="sources">Sources</h2>

<ul>
  <li>https://expressjs.com/en/guide/using-middleware.html</li>
</ul>


	</div>

</section>


		</div>

	</div>


	<footer class="footer">

	<ul class="socials">
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://www.github.com/hannut91" target="_blank" class="socials__item__link" title="Github">
			<i class="fab fa-github" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</ul>

	<div class="footer__copyright">
		<span>© 2019 Yunseok's Dev Blog</span>
		<a href="https://jekyllthemes.io" target="_blank">Jekyll Themes</a>
	</div>

</footer>


	<!-- Javascript Assets -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="/js/simples-min.js"></script>

	
	<!-- Extra Footer JS Code -->
	
	


</body>

</html>
